***********************************************************
[INFO] TRAINING ON RANDOM INSTANCES: portfolio
[INFO] n_items: 20
[INFO] lambda_1: 1
[INFO] lambda_2: 5
[INFO] lambda_3: 5
[INFO] lambda_4: 5
[INFO] capacity_ratio: 0.500000
[INFO] seed: 1
***********************************************************
[INFO] TRAINING PARAMETERS
[INFO] algorithm: DQN
[INFO] batch_size: 64
[INFO] learning_rate: 0.000010
[INFO] hidden_layer: 2
[INFO] latent_dim: 128
[INFO] softmax_beta: 2
[INFO] n_step: -1
***********************************************************
***********************************************************
[INFO] NUMBER OF FEATURES
[INFO] n_feat: 9
***********************************************************
[INFO] Memory Initialized
[INFO] iter time avg_reward_learning loss beta
[DATA] 0 18.49 52.128550560501004 0.36389999999999995 0.0
[DATA] 10 32.81 10.965507575625033 0.2355 0.0036
[DATA] 20 47.18 6.644883858090729 0.2099 0.0076
[DATA] 30 61.48 52.128550560501004 0.20550000000000004 0.0116
[DATA] 40 75.85 10.103583267346195 0.20350000000000001 0.0156
[DATA] 50 90.16 23.13681734218181 0.20240000000000002 0.0196
[DATA] 60 104.75 -15.278407231088726 0.19999999999999998 0.0236
[DATA] 70 119.53 49.147231012256796 0.19660000000000002 0.0276
[DATA] 80 133.81 -1.5174698939229072 0.2091 0.0316
[DATA] 90 148.12 56.51103635429936 0.19200000000000003 0.0356
[DATA] 100 162.43 -40.54439060821349 0.21309999999999996 0.0396
[DATA] 200 246.37 51.81797493161075 0.1918 0.0796
[DATA] 300 329.19 46.57274302943851 0.19379999999999997 0.1196
[DATA] 400 412.2 21.77782114049256 0.1979 0.1596
[DATA] 500 495.36 8.506996221417822 0.1861 0.1996
[DATA] 600 578.61 55.23150271487944 0.19349999999999998 0.2396
[DATA] 700 661.48 44.67566373399528 0.20250000000000004 0.2796
[DATA] 800 744.97 41.91189953815804 0.1993 0.3196
[DATA] 900 827.84 39.46278033133899 0.19470000000000004 0.3596
[DATA] 1000 911.78 49.761767429675075 0.18350000000000002 0.3996
[DATA] 1100 995.68 42.79558475510057 0.1962 0.4396
[DATA] 1200 1079.67 51.171366960362185 0.1789 0.4796
[DATA] 1300 1163.76 52.69475194781813 0.18560000000000001 0.5196
[DATA] 1400 1247.79 47.13725469571548 0.1829 0.5596
[DATA] 1500 1332.36 46.36013543666232 0.1733 0.5996
[DATA] 1600 1415.69 72.00952823248662 0.17500000000000002 0.6396
[DATA] 1700 1499.23 66.18552172172159 0.1652 0.6796
[DATA] 1800 1582.73 58.170057192640286 0.1713 0.7196
[DATA] 1900 1666.23 57.20601733169551 0.168 0.7596
[DATA] 2000 1749.65 67.08966346263767 0.1592 0.7996
[DATA] 2100 1833.06 53.910765532835455 0.14880000000000002 0.8396
[DATA] 2200 1917.04 84.68262959562333 0.14670000000000002 0.8796
[DATA] 2300 2000.95 59.45283724977744 0.1474 0.9196
[DATA] 2400 2084.39 125.86681963285575 0.1429 0.9596
[DATA] 2500 2167.82 88.80941506107285 0.1396 0.9996
[DATA] 2600 2250.99 102.81633352071232 0.1457 1.0396
[DATA] 2700 2333.78 145.04832878853685 0.1459 1.0796
[DATA] 2800 2417.98 71.89241190285148 0.1368 1.1196
[DATA] 2900 2501.33 157.5125370038015 0.13499999999999998 1.1596
[DATA] 3000 2585.11 88.96321734921835 0.14100000000000004 1.1996
[DATA] 3100 2668.41 139.6541926953011 0.13489999999999996 1.2396
[DATA] 3200 2751.59 156.4289284890638 0.13710000000000003 1.2796
[DATA] 3300 2834.82 122.56982739658775 0.1317 1.3196
[DATA] 3400 2917.9 144.05013819285176 0.1367 1.3596
[DATA] 3500 3001.26 179.88419991855596 0.13190000000000002 1.3996
[DATA] 3600 3084.64 124.36853863303433 0.1188 1.4396
[DATA] 3700 3168.69 193.42626591275686 0.13219999999999998 1.4796
[DATA] 3800 3251.8 178.72927071232553 0.12780000000000002 1.5196
[DATA] 3900 3334.8 185.2944458801003 0.12700000000000003 1.5596
[DATA] 4000 3417.84 186.07785256503058 0.12769999999999998 1.5996
[DATA] 4100 3501.14 194.04122478536038 0.12280000000000002 1.6396
[DATA] 4200 3585.27 191.6725019583803 0.1155 1.6796
[DATA] 4300 3669.28 200.64895852788834 0.1263 1.7196
[DATA] 4400 3753.93 189.02229020743695 0.1174 1.7596
[DATA] 4500 3837.94 199.19954227543454 0.11669999999999998 1.7996
[DATA] 4600 3921.88 199.91334764765844 0.11830000000000002 1.8396
[DATA] 4700 4005.57 178.53860657377888 0.11440000000000002 1.8796
[DATA] 4800 4088.79 199.66627011617254 0.1134 1.9196
[DATA] 4900 4171.96 206.2500228856303 0.12460000000000002 1.9596
[DATA] 5000 4255.01 216.84812665040525 0.1182 1.9996
[DATA] 5100 4338.48 220.16919335479386 0.11339999999999997 2
[DATA] 5200 4421.43 218.774611523383 0.1206 2
[DATA] 5300 4504.39 214.138322906566 0.11489999999999999 2
[DATA] 5400 4587.44 210.01308209845476 0.11599999999999998 2
[DATA] 5500 4670.27 214.33477483532633 0.10479999999999998 2
[DATA] 5600 4753.49 240.08370433674207 0.10909999999999999 2
[DATA] 5700 4836.68 240.44970465857725 0.1073 2
[DATA] 5800 4921.0 249.72596309731063 0.10910000000000002 2
[DATA] 5900 5004.57 258.30767439079193 0.1072 2
[DATA] 6000 5088.16 252.46138010440055 0.0995 2
[DATA] 6100 5172.08 259.70307053728993 0.0996 2
[DATA] 6200 5255.42 262.860727908109 0.09819999999999998 2
[DATA] 6300 5338.54 264.6786709409796 0.0992 2
[DATA] 6400 5421.65 261.8073501155825 0.0956 2
[DATA] 6500 5505.3 252.56049674374606 0.0983 2
[DATA] 6600 5589.11 237.70380199340732 0.0957 2
[DATA] 6700 5672.47 240.80160406450145 0.10239999999999999 2
[DATA] 6800 5755.93 256.1436430344813 0.08460000000000001 2
[DATA] 6900 5839.19 267.05858436957556 0.0853 2
[DATA] 7000 5922.25 227.85598380198385 0.09280000000000001 2
[DATA] 7100 6005.79 246.43750900140597 0.0864 2
[DATA] 7200 6088.91 270.37321199381745 0.0801 2
[DATA] 7300 6172.66 242.29260528214266 0.08670000000000001 2
[DATA] 7400 6255.85 258.67973957271823 0.07980000000000002 2
[DATA] 7500 6339.21 271.21911102207815 0.081 2
[DATA] 7600 6422.45 239.50502639207997 0.07700000000000001 2
[DATA] 7700 6505.31 294.2873264472985 0.08389999999999999 2
[DATA] 7800 6588.47 233.84556901772856 0.0827 2
[DATA] 7900 6671.53 290.4586730554108 0.07959999999999999 2
[DATA] 8000 6755.26 278.10225552365716 0.0858 2
[DATA] 8100 6838.28 253.1770556015912 0.07970000000000001 2
[DATA] 8200 6921.4 251.2731157284972 0.07520000000000002 2
[DATA] 8300 7005.42 296.1123893108719 0.0787 2
[DATA] 8400 7089.55 234.61927823022037 0.0775 2
[DATA] 8500 7173.09 270.9858963053181 0.06910000000000001 2
[DATA] 8600 7255.74 296.02038097786794 0.0783 2
[DATA] 8700 7338.93 264.5031067264335 0.0778 2
[DATA] 8800 7421.46 301.4340541016069 0.07980000000000001 2
[DATA] 8900 7504.04 282.78954747474364 0.0784 2
[DATA] 9000 7586.6 271.3934634961986 0.0767 2
[DATA] 9100 7669.22 280.4906296399319 0.07650000000000001 2
[DATA] 9200 7751.77 280.64898136459175 0.07600000000000001 2
[DATA] 9300 7834.31 280.3057046140556 0.07409999999999999 2
[DATA] 9400 7917.61 284.1839524352333 0.07590000000000001 2
[DATA] 9500 8000.18 302.8663050888619 0.0744 2
[DATA] 9600 8082.75 299.6195171033589 0.07680000000000001 2
[DATA] 9700 8165.36 304.99764104702956 0.0701 2
[DATA] 9800 8247.93 303.8300785911277 0.0718 2
[DATA] 9900 8330.46 294.9297267704221 0.06899999999999999 2
[DATA] 10000 8412.34 306.1577866797816 0.0638 2
[DATA] 10100 8493.63 303.16685029527326 0.0686 2
[DATA] 10200 8575.35 276.8324964619608 0.0676 2
[DATA] 10300 8656.23 309.4716557760603 0.0721 2
[DATA] 10400 8737.17 294.7882742060123 0.07079999999999999 2
[DATA] 10500 8818.31 303.7634159021942 0.06620000000000001 2
[DATA] 10600 8899.2 289.23594772372894 0.07150000000000001 2
[DATA] 10700 8980.18 300.6811778564051 0.07500000000000001 2
[DATA] 10800 9061.8 272.7361884140969 0.0682 2
[DATA] 10900 9144.18 306.6392397929842 0.07149999999999998 2
[DATA] 11000 9225.88 294.40157023185344 0.0723 2
[DATA] 11100 9307.6 307.3586057842133 0.0693 2
[DATA] 11200 9389.32 297.74354649968967 0.0712 2
[DATA] 11300 9470.51 305.8488015809432 0.07100000000000001 2
[DATA] 11400 9551.58 304.3257974385307 0.073 2
[DATA] 11500 9632.55 301.94949957487364 0.0699 2
[DATA] 11600 9714.21 311.5229687922115 0.0732 2
[DATA] 11700 9795.28 307.8073935993395 0.0677 2
[DATA] 11800 9876.33 303.6688794378386 0.06890000000000002 2
[DATA] 11900 9957.38 307.58560458173554 0.0709 2
[DATA] 12000 10038.45 290.975244610301 0.0694 2
[DATA] 12100 10119.85 299.2669499205666 0.06820000000000001 2
[DATA] 12200 10201.4 252.74782854721187 0.06659999999999999 2
[DATA] 12300 10282.8 304.80892792549594 0.06769999999999998 2
[DATA] 12400 10364.92 298.29129428138555 0.0695 2
[DATA] 12500 10446.29 288.0964081527733 0.06890000000000002 2
[DATA] 12600 10527.68 308.86871462538807 0.06509999999999999 2
[DATA] 12700 10609.06 309.6169447613804 0.0679 2
[DATA] 12800 10690.46 310.73984047365695 0.06770000000000001 2
[DATA] 12900 10771.56 310.5417265382421 0.06889999999999999 2
[DATA] 13000 10852.64 291.7857460781115 0.0664 2
[DATA] 13100 10934.53 306.5109820440111 0.0612 2
[DATA] 13200 11015.63 308.61161130888087 0.06590000000000001 2
[DATA] 13300 11096.77 283.43536764732426 0.06249999999999999 2
[DATA] 13400 11177.96 306.89654724550235 0.06459999999999999 2
[DATA] 13500 11259.05 298.5088034649623 0.06480000000000001 2
[DATA] 13600 11339.97 302.8175312741476 0.0635 2
[DATA] 13700 11421.25 302.3810428042589 0.0596 2
[DATA] 13800 11502.55 309.51166897858616 0.0585 2
[DATA] 13900 11584.41 309.87819128908933 0.06570000000000001 2
[DATA] 14000 11665.63 304.48365189195005 0.056299999999999996 2
[DATA] 14100 11747.0 306.0261312494572 0.0614 2
[DATA] 14200 11828.35 309.79774753000925 0.0647 2
[DATA] 14300 11909.72 298.2532082992341 0.05939999999999999 2
[DATA] 14400 11991.07 290.31181131925604 0.0641 2
[DATA] 14500 12072.39 300.6864446763447 0.06300000000000001 2
[DATA] 14600 12154.39 301.4602709562277 0.0561 2
[DATA] 14700 12235.38 307.40677257505735 0.06029999999999999 2
[DATA] 14800 12316.44 309.6048941107306 0.0596 2
[DATA] 14900 12397.46 285.1884209368504 0.05789999999999999 2
[DATA] 15000 12478.52 308.0188900775534 0.059699999999999996 2
[DATA] 15100 12559.54 311.01700908967695 0.0589 2
[DATA] 15200 12640.56 300.4651862036363 0.06130000000000001 2
[DATA] 15300 12722.21 308.27966345597497 0.0561 2
[DATA] 15400 12803.23 290.4089029934762 0.0643 2
[DATA] 15500 12884.31 307.9324051172873 0.062099999999999995 2
[DATA] 15600 12965.37 295.73797537894393 0.0575 2
[DATA] 15700 13046.86 269.1034225875612 0.0601 2
[DATA] 15800 13128.35 311.12703644453603 0.0596 2
[DATA] 15900 13209.91 305.8217403813163 0.0571 2
[DATA] 16000 13291.43 303.75467132462734 0.05840000000000001 2
[DATA] 16100 13373.08 306.35364506091935 0.058699999999999995 2
[DATA] 16200 13454.25 305.74947583110793 0.0634 2
[DATA] 16300 13535.43 291.77782057220475 0.0607 2
[DATA] 16400 13616.73 312.28605632402395 0.06039999999999999 2
[DATA] 16500 13698.04 302.0239631605883 0.05699999999999999 2
[DATA] 16600 13779.28 308.011668814593 0.0573 2
[DATA] 16700 13860.59 301.8225465100097 0.05710000000000001 2
[DATA] 16800 13942.5 308.80790030317496 0.058499999999999996 2
[DATA] 16900 14023.74 302.6761522034597 0.057699999999999994 2
[DATA] 17000 14104.98 306.7409967715719 0.05900000000000001 2
[DATA] 17100 14186.14 292.6833246059212 0.06040000000000001 2
[DATA] 17200 14267.51 286.67731238605387 0.06470000000000001 2
[DATA] 17300 14348.96 308.16499764096795 0.058 2
[DATA] 17400 14430.26 309.3158042820428 0.0603 2
[DATA] 17500 14512.23 309.5145659762729 0.061700000000000005 2
/home/capque/dp-solver/src/problem/portfolio/learning/trainer_dqn.py:310: RuntimeWarning: invalid value encountered in true_divide
  logits = logits / div
Traceback (most recent call last):
  File "main_training_dqn_portfolio.py", line 68, in <module>
    trainer.run_training()
  File "/home/capque/dp-solver/src/problem/portfolio/learning/trainer_dqn.py", line 90, in run_training
    loss, beta = self.run_episode(i, memory_initialization=False)
  File "/home/capque/dp-solver/src/problem/portfolio/learning/trainer_dqn.py", line 181, in run_episode
    action = self.soft_select_action(nn_input, avail, temperature)
  File "/home/capque/dp-solver/src/problem/portfolio/learning/trainer_dqn.py", line 324, in soft_select_action
    action_idx = np.random.choice(np.arange(len(probabilities)), p=probabilities)
  File "mtrand.pyx", line 793, in numpy.random.mtrand.RandomState.choice
ValueError: probabilities contain NaN
